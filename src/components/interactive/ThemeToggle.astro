---
import { Sun, Moon } from '@lucide/astro';
---

<button
  x-data="{
    theme: localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'),
    toggle() {
      this.theme = this.theme === 'dark' ? 'light' : 'dark';
      localStorage.setItem('theme', this.theme);
      if (this.theme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    },
    init() {
        // Sync initial state incase it changed outside
        this.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    }
  }"
  @click="toggle()"
  type="button"
  class="relative inline-flex h-9 w-9 items-center justify-center rounded-md bg-transparent transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"
  aria-label="Toggle theme"
>
  <!-- Sun Icon (Show when Dark) -->
  <div x-show="theme === 'dark'" style="display: none;">
    <Sun class="h-4 w-4 transition-all" />
  </div>

  <!-- Moon Icon (Show when Light) -->
  <div x-show="theme === 'light'">
    <Moon class="h-4 w-4 transition-all" />
  </div>
</button>
